#!/bin/sh

########################################################################################################################

export PYTHONUNBUFFERED=1

########################################################################################################################

(
  ######################################################################################################################

  cd /usr/share/nginx/html/

  ######################################################################################################################

  if [ ! -f ./awf.py ]
  then
    wget -O ./awf.py https://raw.githubusercontent.com/ami-team/awfwebpack/master/tools/awf_stub.py

    chmod a+x ./awf.py
  fi

  ######################################################################################################################

  ./awf.py --update-prod

  ######################################################################################################################

  if [ ! -f ./index.html ]
  then
    ./awf.py --create-home-page --home-page-title="${AMI_HOME_PAGE_TITLE}" --home-page-endpoint="${AMI_HOME_PAGE_ENDPOINT}"
  fi

  ######################################################################################################################

) || exit 1

########################################################################################################################
